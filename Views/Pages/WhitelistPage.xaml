<Page x:Class="OpenRdpGuard.Views.Pages.WhitelistPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:vm="clr-namespace:OpenRdpGuard.ViewModels"
      mc:Ignorable="d"
      d:DataContext="{d:DesignInstance vm:WhitelistViewModel, IsDesignTimeCreatable=True}">

    <ScrollViewer>
        <StackPanel Margin="12">
            <Border Style="{StaticResource CardBorderStyle}">
                <StackPanel>
                    <TextBlock Text="IP 白名单" Style="{StaticResource PageTitleTextStyle}" Margin="0,0,0,8" />
                    <TextBlock Text="开启白名单模式后，仅允许白名单中的 IP 连接 RDP 端口。" Style="{StaticResource MutedTextStyle}" Margin="0,0,0,8" />
                    <CheckBox Content="启用白名单模式" IsChecked="{Binding IsWhitelistEnabled}" Command="{Binding ToggleWhitelistCommand}" Margin="0,0,0,8" />
                </StackPanel>
            </Border>

            <Border Style="{StaticResource CardBorderStyle}">
                <StackPanel>
                    <TextBlock Text="白名单列表" Style="{StaticResource SectionTitleTextStyle}" Margin="0,0,0,8" />
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBox Width="260" Text="{Binding IpToAdd}" />
                        <Button Content="添加" Margin="8,0,0,0" Style="{StaticResource PrimaryButtonStyle}" Command="{Binding AddIpCommand}" />
                    </StackPanel>

                    <Border BorderBrush="{DynamicResource CardBorderBrush}" BorderThickness="1" CornerRadius="4">
                        <ListBox ItemsSource="{Binding AllowedIps}" BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="&#xE8F1;" FontFamily="Segoe MDL2 Assets" Foreground="{DynamicResource SuccessBrush}" Margin="0,0,8,0" />
                                        <TextBlock Text="{Binding}" VerticalAlignment="Center" />
                                    </StackPanel>
                                    <Button Grid.Column="1" Content="移除" Margin="8,0,0,0" Style="{StaticResource PrimaryButtonStyle}"
                                            Command="{Binding DataContext.RemoveIpCommand, RelativeSource={RelativeSource AncestorType=Page}}"
                                            CommandParameter="{Binding}" />
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>

